# API Configuration for Hierarchical Blockchain Framework
# This configuration defines API key verification settings

# Framework Information
framework:
  description: "API security configuration with key verification and access control policies for the hierarchical blockchain framework"

# API Security Configuration
api_security:
  verify_key:
    enabled: true
    key_location: "header"  # Options: query, header
    key_name: "x-api-key"   # Header name or query parameter name
    cache_ttl: 300          # Seconds for caching verified keys (5 minutes)
    revocation_check: "daily"  # How often to check for revoked keys

# Alternative configurations for different deployment scenarios
development:
  api_security:
    verify_key:
      enabled: false  # Disable for development/testing
      key_location: "header"
      key_name: "x-api-key"
      cache_ttl: 60   # Shorter cache for development
      revocation_check: "hourly"

production:
  api_security:
    verify_key:
      enabled: true
      key_location: "header"
      key_name: "x-api-key"
      cache_ttl: 300  # 5 minutes cache
      revocation_check: "daily"

# Query parameter based configuration (alternative)
query_based:
  api_security:
    verify_key:
      enabled: true
      key_location: "query"
      key_name: "apikey"
      cache_ttl: 300
      revocation_check: "daily"

# Endpoint-specific validation settings
endpoint_validation:
  pre_call: true      # Validate requests before processing
  post_call: false    # Skip post-call validation for performance
  command_audit: true # Audit all API commands

# Rate limiting settings (future enhancement)
rate_limiting:
  enabled: false
  requests_per_minute: 60
  burst_limit: 10

# API versioning settings
versioning:
  current_version: "v3"
  supported_versions: ["v1", "v2", "v3"]
  deprecation_warnings: true

# Logging configuration for API security events
logging:
  security_events: true
  audit_trail: true
  log_level: "INFO"
  log_format: "json"
  
# Error handling configuration
error_handling:
  detailed_errors: false  # Don't expose detailed errors in production
  error_codes:
    missing_key: 401
    invalid_key: 401
    revoked_key: 401
    insufficient_permissions: 403
    rate_limit_exceeded: 429

# Resource permissions mapping
permissions:
  events:
    - "add_event"
    - "query_events"
    - "trace_entity"
  
  chains:
    - "create_chain"
    - "query_chain"
    - "inspect_blocks"
  
  proofs:
    - "submit_proof"
    - "verify_proof"
    - "query_proofs"
  
  admin:
    - "manage_keys"
    - "view_audit_logs"
    - "system_status"

# Default permissions for different user types
default_permissions:
  demo_user: ["events", "chains"]
  standard_user: ["events", "proofs"]
  admin_user: ["all"]
  system_service: ["events", "chains", "proofs"]